# Excel表合并工具使用说明

## 📋 功能说明
将员工基本信息表与员工绩效表合并，在基本信息基础上增加2024年第4季度的绩效评分。

## 📁 文件说明

### 主要脚本
1. **`simple_merger.py`** - 简化版合并脚本（推荐新手使用）
2. **`advanced_merger.py`** - 高级合并脚本（智能筛选2024Q4数据）
3. **`excel_merger.py`** - 完整版合并脚本（功能最全面）

### 辅助文件
- **`run_merger.bat`** - Windows批处理文件，双击即可运行
- **`requirements.txt`** - Python依赖包列表

## 🚀 使用方法

### 方法1：使用批处理文件（最简单）
1. 双击运行 `run_merger.bat`
2. 等待合并完成
3. 查看生成的 `员工信息与绩效合并表.xlsx` 文件

### 方法2：直接运行Python脚本
```bash
# 安装依赖
pip install pandas openpyxl

# 运行简化版
python simple_merger.py

# 或运行高级版（推荐）
python advanced_merger.py
```

## 📊 输出文件说明

### 简化版输出：`员工信息与绩效合并表.xlsx`
- **合并数据**：包含所有合并后的数据
- **数据概览**：统计信息

### 高级版输出：`员工信息与2024Q4绩效合并表.xlsx`
- **合并数据**：包含所有合并后的数据
- **数据概览**：详细统计信息
- **基本信息表**：原始基本信息数据
- **绩效表**：原始绩效数据
- **2024Q4绩效**：筛选出的2024年第4季度绩效数据

## 🔧 合并逻辑

1. **自动识别关联键**：程序会自动找到两个表的共同字段作为关联键
2. **左连接合并**：以员工基本信息表为主，添加绩效信息
3. **智能筛选**：高级版会自动筛选2024年第4季度的绩效数据
4. **数据清理**：自动处理缺失值和重复数据

## 📈 合并结果

合并后的表将包含：
- 员工基本信息的所有字段
- 2024年第4季度的绩效评分字段
- 字段命名规则：基本信息字段保持原名，绩效字段添加"_绩效"后缀

## ⚠️ 注意事项

1. **文件位置**：确保两个Excel文件在当前目录下
2. **文件格式**：必须是.xlsx格式
3. **数据质量**：建议先检查数据完整性
4. **备份**：建议先备份原始文件

## 🐛 故障排除

### 常见问题
1. **找不到文件**：检查文件名是否正确
2. **编码错误**：使用UTF-8编码运行脚本
3. **依赖缺失**：运行 `pip install pandas openpyxl`
4. **合并失败**：检查两个表是否有共同字段

### 错误信息
- `ModuleNotFoundError`：需要安装pandas和openpyxl
- `FileNotFoundError`：检查Excel文件是否存在
- `KeyError`：检查表结构是否正确

## 📞 技术支持

如果遇到问题，请检查：
1. Python版本（建议3.7+）
2. 依赖包版本
3. Excel文件格式
4. 数据完整性

## 🎯 预期结果

合并完成后，您将得到一个包含以下信息的Excel文件：
- 员工基本信息（姓名、部门、职位等）
- 2024年第4季度绩效评分
- 数据统计概览
- 原始数据备份（高级版）
